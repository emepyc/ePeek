host: 127.0.0.1
port: 4001
safe: true
pygments: true
baseurl : /tnt
api :
    - name : tree
      elements :
           - name : Tree Visualization
             preamble : |
                        Trees can be created using the tnt.tree method. The returned tree is configurable via the methods explained below. An example of use looks like:
             example : |
                        var tnt = tnt.tree()
                                     .data (tnt.tree.parse_newick (newick))
                                     .layout (tnt.tree.layout.vertical()
                                              .width (650))
                                     .label (tnt.tree.label.text()
                                              .height(15))
             elements :
                - name : tree
                  path : tnt
                  args : null
                  desc : creates a new tree visualization
                  full : Creates a new tree visualization. This tree visualization needs to be configured via its public methods explained below.
                  example : |
                         var tnt = tnt.tree()
                         tnt (document.getElementById ('my_div'));
                - name : data
                  path : tree
                  args : object
                  desc : sets the tree data (in pure javascript)
                  full : Sets the data to be used in the tree visualization (the tree). This tree needs to be a tree like structure in JSON format like the one shown below. This JSON object can be obtained with <a href="#parse_newick">tnt.tree.parse_json</a> or <a href="#parse_nhx">tnt.tree.parse_nhx</a>
                  example : |
                         var tree_obj = {
                            name: "F",
                            children: [
                               {name: "A", length: 0.1},
                               {name: "B", length: 0.2},
                               {
                                  name: "E",
                                  length: 0.5,
                                  children: [
                                     {name: "C", length: 0.3},
                                     {name: "D", length: 0.4}
                                  ]
                                }
                            ]
                         }
                - name : duration
                  path : tree
                  args : number
                  desc : specifies duration of the tree transitions
                  full : Specifies the duration of the transitions on trees. If no argument is provided it returns the current duration. By default this value is 500ms
                  example : |
                            var tree_vis = tnt.tree()
                                             .duration(750);
                            tree_vis.duration(); // returns 750
                - name : on_click
                  path : tree
                  args : callback
                  desc : specifies the behaviour on nodes when they are clicked [REVISE]
                  full : Specifies the behaviour of the node when they are clicked. It accepts a callback that is called every time a click event is fired on a node. This callback receives the node as its argument. By default the nodes do not react to mouse clicks.
                  example : |
                            var tree_vis = tnt.tree()

                            // collapse node on click
                            tree_vis.on_click (function (node) {
                                node.toggle_node (node)
                                tree_vis.update();
                            });

                            // show a tooltip on click
                            tree_vis.on_click (tree_vis.tooltip());
                - name : on_dbl_lick
                  path : tree
                  args : callback
                  desc : specifies the behaviour on nodes when they are double-clicked [REVISE]
                  full : Specifies the behaviour of nodes when they are double clicked. It accepts a callback that is called every time a double click event is fired on a node. This callback receives the node as its argument. By default the nodes do not react to mouse clicks
                  example : null
                - name : link_color
                  path : tree
                  args : string | callback
                  desc : specifies the color of branches [REVISE]
                  full : Specifies the color of the branches in the tree. This color can be given as a string specifying the name of the color (like "blue") or its hexadecimal code (like '#00FF00'). To get per branch colors use a callback instead. This callback will be called on each branch with an object containing the source and destination nodes (as "source" and "dest" fields).
                  example : |
                            var tree_vis = tnt.tree()
                                             .link_color (function (link) {
                                                var color = 'grey';
                                                if (link.source && link.source.type) {
                                                   switch (link.source.type) {
                                                      case "speciation" :
                                                        color = "green";
                                                        break;
                                                      case "duplication" :
                                                        color = "red";
                                                        break;
                                                   }
                                                }
                                                return color;
                                              });
                - name : node_color
                  path : tree
                  args : string | callback
                  desc : specifies the color of nodes [REVISE]
                  full : Specifies the color of the nodes in the tree. This color can be given as a string specifying the name of the color (like "blue") or its hexadecimal code (like "#00FF00"). To get per node colors use a callback instead. This callback will be called on each node with the node object.
                  example : |
                            var tree_vis = tnt.tree()
                                             .node_color (function (node) {
                                                if (node.type === 'speciation') {
                                                   return "green";
                                                } else {
                                                   return "red";
                                                }
                                              });
                - name : node_circle_size
                  path : tree
                  args : integer
                  desc : specifies the size of the nodes [REVISE]
                  full : Specifies the size of the node in pixels
                  example : |
                            var tree_vis = tnt.tree()
                                            .node_circle_size(5);
           - name : Nodes
             preamble : |
                        TnT provides several methods for tree manipulation, these include nodes searching, mapping callbacks to nodes, etc. Instead of providing these methods to the tree visualization objects, TnT provides a special object for these operations. These objects can be obtained using the <a href="#root">root</a> method on the tree visualization object. Since the tree data object is completely separated from the visualization, it is also possible to use them directly using the <i>tnt.tree.node</i> method in tnt. For example
             example : |
                       var tree_vis = tnt.tree()
                                        .data (tnt.tree.parse_newick (newick))

                       // tree data obtained from the visualization
                       var root = tree_vis.root();

                       // get the node with name 'human' and 'mouse'
                       var human_node = root.find_node_by_field ('human', 'name');
                       var mouse_node = root.find_node_by_field ('mouse', 'name');

                       // get the node that is the lca of human and mouse
                       var lca = root.lca ([human_node, mouse_node]);

                       // lca is a tnt.tree.node itself
                       lca.find_node_by_field('human', 'name');

                       // nodes can also be obtained independently of the visualization...
                       // ... via the parse_newick or parse_nhx methods
                       var root = tnt.tree.parse_newick (newick);

                       // ... or passing a json object directly to tnt.tree.node()
                       var root = tnt.tree.node(tree_object);
                       var human_node = root.find_node_by_field ('human', 'name');
             elements :
                - name : tree
                  path : root
                  args : null
                  desc : retrieves the root node of the tree used in the visualization
                  full : Retrieves the root node of the tree used in the visualization. This object is used to manipulate and query the tree in different ways (see below for the supported methods).
                  example : |
                            var tree_vis = tnt.tree()
                                             .data (tnt.tree.parse_newick (newick));
                            var root = tree_vis.root();
                - name : data
                  path : node
                  args : null
                  desc : retrieves the tree JSON object
                  full : Retrieves the tree JSON object. This is the same JSON object used to set up the tree with all the original fields.
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            // javascript object of the tree (JSON)
                            var tree_object = tree_data.data();
                - name : find_node_by_field
                  path : node
                  args : value, string | callback
                  desc : retrieves a node based on a field
                  full : Retrieves a node based on a given field. This method accepts two parameters, the first one being the searched value (string, numeric, etc...), the second one can be a field name in the tree object or a callback that knows how to reach that value. This callback is called with the node information. The returned node is also a node object itself. For example
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            // Using a field name
                            var node = root.find_node_by_field ('human', 'common_name');

                            // Using a callback (for example, common_name is not a top level field in the tree object)
                            var node = root.find_node_by_field ('human', function (node) {
                               return node.taxonomy.common_name;
                            });
                - name : find_node_by_name
                  path : node
                  args : string
                  desc : retrieves a node based on its name field
                  full : Retrieves a node based on its 'name' field. This is a special case of <a href="#find_node_by_field">find_node_by_field</a>
                  example : null
                - name : toggle_node
                  path : node
                  args : null
                  desc : collapses / uncollapses the branch at the current node [REVISE]
                  full : Toggles collapsibility of the current branch at the current node. If the current node is not collapsed, it collapses it, if it is already collapsed, it uncollapses it.
                  example : |
                            var tree_vis = tnt.tree()
                                             .data(...)
                                             .layout(...);
                            tree_vis.on_click (function (node) {
                                node.toggle_node();
                                tree_vis.update();
                            });
                - name : is_collapsed
                  path : data
                  args : null
                  desc : returns true on collapsed nodes [REVISE -- Only on terminals? Should not be on any node with a collpased node upstream?]
                  full : Returns true if the branch is collapsed at the current node
                  example : null
                - name : lca
                  path : node
                  args : [node1, node2, ...]
                  desc : returns the lowest common ancestor of a set of leaves
                  full : Returns the lowest common ancestor node of a set of leaves. These leaves have to be downstream the current node
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            var human_node = root.find_node_by_name('human');
                            var mouse_node = root.find_node_by_name('mouse');
                            var lca_node = root.lca(human_node, mouse_node);
                - name : get_all_leaves
                  path : node
                  args : null
                  desc : returns all the leaves under the node
                  full : Returns all the leaves under the current node. These leaves are returned as nodes
                - name : upstream
                  path : node
                  args : callback
                  desc : applies a callback to all the upstream nodes of the current node
                  full : Applies the passed callback to all the ancestors of the current node. This callback is called passing each node as its argument. The ancestors are passed in order until the root of the tree is reached.
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            var human_node = root.find_node_by_name ('human');
                            human_node.upstream (function (node) {
                               // this callback is called with all the upstream nodes to human_node
                               // until the root node is reached (included)
                            });
                - name : subtree
                  path : node
                  args : [node1, node2, ...]
                  desc : returns a new subtree given a set of leaves
                  full : Returns the root of a new tree that has been made by calculating the lowest common ancestor of the given leaves, pruning the singleton nodes and copying the resulting tree into a new tree structure. This method is used by the library to create new tree structures based on the initial one. Its argument is an array of leaves. Because the returned subtree has copies of the original nodes, changing the former does not affect the latter.
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            var leaves = ... // get leaves
                            var subtree = root.subtree (leaves);
                - name : present
                  path : node
                  args : callback
                  desc : tests all the descendants of the current node using a callback
                  full : Tests all the downstream nodes of the current node using the given callback. This callback on every node. The callback should explicitely return 'true' or 'false'
                  example : |
                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            root.present (function (node) {
                               return (node.property ('my_field') === 1);
                            });
                - name : sort
                  path : node
                  args : callback
                  desc : orders the descendant nodes based on the given callback
                  full : Recursively orders the children of each downstream node based on the given callback. This ordering does not affect the tree topology. The given callback is called on each pair of children and both nodes are passed as its arguments. As with a normal javascript sort function, this callback is expected to return -1, 0 or 1 if the first node should go before the second, if there is a tie or if the second should go before the first respectively (see the <a href="http://www.w3schools.com/jsref/jsref_sort.asp">javascript sort function documentation</a> for details)
                  example : |
                            // Helper function to get the lowest value in
                            // the subnode -- this is used in the sort cbak
                            var get_highest_val = function (node, prop) {
                               var highest = 0;
                               node.apply(function (n) {
                                  if (n.property(prop) === "") {
                                      return;
                                  }
                                  var val = parseFloat(n.property(prop));
                                  if (val > highest) {
                                     highest = val;
                                  }
                               });
                              return highest;
                            };

                            var root = tnt.tree.node (tnt.tree.parse_newick (newick));
                            root.sort (function (node1, node2) {
                                var highest1 = get_highest_val (node1, 'length');
                                var highest2 = get_highest_val (node2, 'length');
                                return highest1 - highest2;
                            });
                - name : apply
                  path : node
                  args : callback
                  desc : applies the given callback to all the descendants of the node
                  full : Recursively applies the given callback to each children of the current node. The node is passed to the callback as its argument. See <a href="#sort">node.sort</a> for a example
                  example : null
                - name : property
                  path : node
                  args : string | callback
                  desc : allows access to properties in the nodes data
                  full : 
                - name : tree.is_leaf
                  desc : returns true on leaves
                - name : tree.node_name
                  desc : returns the property 'name' of nodes [REVISE]
                - name : tree.root_dist
                  desc : returns the distance of the node to the root based on branch lengths
                - name : tree.children
                  desc : returns all the children of the node
                - name : tree.parent
                  desc : returns the parent of the node
           - name : Layouts
             elements :
                - name : tree.layout
                  desc : specifies the layout to be used in the tree visualization
                - name : layout.scale
                  desc : specifies if the branches should be scaled based on branch lengths
                - name : layout.width
                  desc : specifies the width of the tree layout
                - name : tree.layout.vertical
                  desc : vertical layout
                - name : tree.layout.radial
                  desc : radial layout
           - name : Labels
             elements :
                - name : tree.label
                  desc : specify the label type to be used in the tree visualization
                - name : label.height
                  desc : specifies the height of the label
                - name : tree.label.text
                  desc : text based labels
                - name : text.fontsize
                  desc : sets the fontsize of the label
                - name : text.color
                  desc : sets the color of the text
                - name : text.text
                  desc : specifies the field to inspect for names
                - name : tree.label.img
                  desc : image based labels
                - name : img.src
                  desc : specifies the path where the image labels can be found
                - name : tree.label.composite
                  desc : labels made of two or more simple labels
                - name : composite.add_label
                  desc : adds a new simple label to the composite label
                - name : composite.remove
                  desc : removes the simple labels from the composite
           - name : Annotation
             elements :
                - name : tree
                  desc : sets the tree part of the annotated tree
                - name : annotation
                  desc : sets the annotation part of the annotated tree
                - name : track
                  desc : specifies a callback to use to create new tracks based on leaves
                - name : update
                  desc : updates both the tree and the annotation
                - name : ruler
                  desc : sets the ruler/s to be displayd in the annotation
                - name : key
                  desc : specifies the key used to link tree nodes and tracks
           - name : Input trees
             elements :
                - name : tree.parse_newick
                  desc : parses newick formatted trees
                - name : tree.parse_nhx
                  desc : parses nhx formatted trees
    - name : track
      elements :
           - name : Track Visualization
             elements :
                - name : tnt.track
                  desc : defines a new track visualization
                - name : track.from
                  desc : defines the current lower coordinate
                - name : track.to
                  desc : defines the current upper coordinate
                - name : track.left
                  desc : defines the left limit (ie the minimum possible value) of the track
                - name : track.right
                  desc : defines the right limit (ie the maximum possible value) of the track
                - name : track.zoom_out
                  desc : defines the zoom out limit of the track
                - name : track.zoom_in
                  desc : defines the zoom in limit of the track
                - name : track.start
                  desc : starts (or re-starts) the visualization
                - name : track.move_right
                  desc : moves the track right the specified amount
                - name : track.move_left
                  desc : moves the track left the specified amount
                - name : track.zoom
                  desc : zooms in/out the track the specified amount
                - name : track.reorder
                  desc : reorders the tracks based on the array of tracks given as argument
                - name : track.add_track
                  desc : adds a new track to the track visualization
                - name : track.remove_track
                  desc : removes the specified track from the visualization
                - name : track.tracks
                  desc : returns all the tracks in the visualization
                - name : track.width
                  desc : specifies the width of the track visualization
                - name : track.allow_drag
                  desc : specifies the draggability of the tracks in the visualization
           - name : Tracks
             elements :
                - name : track.track
                  desc : defines the track object
                - name : track.background_color
                  desc : defines the background color of the track
                - name : track.height
                  desc : defines the height of the track
           - name : Data
             elements :
                - name : track.data
                  desc : base data object
                - name : data.update
                  desc : specifies how the data is updated
                - name : data.retriever.sync
                  desc : specifies a synchronous data retriever 
                - name : data.retriever.async
                  desc : specifies an asynchronous data retriever
                - name : async.url
                  desc : specifies a url for the asynchronous call
                - name : data.retriever.ensembl
                  desc : specifies a data retriever based on the Ensembl REST server
                - name : ensembl.endpoint
                  desc : specifies the Ensembl REST endpoint
                - name : track.data.gene
                  desc : updater using the ensembl retriever
                - name : track.data.empty
                  desc : updater for data independent tracks
           - name : Features
             elements :
                - name : track.feature
                  desc : base object for features
                - name : feature.foreground_color
                  desc : defines the foreground color of the elements
                - name : feature.info
                  desc : defines the info to display when an element is clicked [REVISE]
                - name : feature.create
                  desc : sets a new callback to create new elements
                - name : feature.mover
                  desc : sets a new callback to move the elements
                - name : feature.updater
                  desc : specifies how the current elements should be visualy updated
                - name : feature.guider
                  desc : defines the visual aspect not associated with elements
                - name : track.feature.block
                  desc : defines block based features
                - name : track.feature.axis
                  desc : defines axes based features
                - name : axis.orientation
                  desc : specifies the orientation of the axis feature
                - name : track.feature.location
                  desc : defines location based features
                - name : track.feature.ensembl
                  desc : defines track visualizations similar to the old Ensembl tracks in trees
                - name : track.feature.vline
                  desc : defines vertical lines elements
                - name : track.feature.sequence
                  desc : defines sequence elements
                - name : track.feature.gene
                  desc : defines gene like elements
                - name : track.feature.area
                  desc : defines area elements
                - name : track.feature.line
                  desc : defines line elements
                - name : line.tension
                  desc : defines the tension of the line
                - name : line.x
                  desc : defines the field to be used as the 'x' value
                - name : line.y
                  desc : defines the field to be used as the 'y' value
           - name : Layouts
             elements :
                - name : track.layout.identity
                  desc : defines layouts for tracks that doesn't need layouts
                - name : track.layout.feature
                  desc : defines a feature layout that avoids overlaps
                - name : feature.height
                  desc : sets the total height of the layout
                - name : feature.elements
                  desc : gets the elements in the layout
                - name : feature.scale
                  desc : specifies the scale to convert data to visualization coordinates
